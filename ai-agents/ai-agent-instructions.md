# AIエージェント実行指示書

## 概要

このドキュメントは、Commander（統括者）とWorker（作業者）の役割でAIエージェントを活用してタスクを実行するための指示書です。

## エージェントの役割

### Commander（統括者）
- タスク全体の進行管理
- Workerへの作業指示
- 成果物のレビューと統合
- 進捗の報告

### Worker（作業者）
- 具体的な実装作業
- テストの作成と実行
- ドキュメントの作成
- Commanderへの報告

## 基本的な実行フロー

```
1. Commanderがタスクを理解
2. Workerに具体的な作業を指示
3. Workerが実装
4. Commanderがレビュー
5. 必要に応じて修正
6. 完了報告
```

## タスク実行の指示テンプレート

### 初回指示（タスク開始時）

```markdown
# タスク実行指示

## 役割設定
あなたはCommander（統括者）として、以下のタスクを管理してください。
必要に応じてWorker（作業者）の役割に切り替えて実装を行ってください。

## 実行するタスク
[タスク番号とタイトル]
ai-agents/todos/[タスクファイル名]

## プロジェクト情報
- リポジトリ: https://github.com/boarnasia/site2
- ブランチ: [作業ブランチ名]
- コンテキスト: AI_CODING_CONTEXT.md

## 実行手順
1. タスクファイルを読み込んで内容を理解
2. 必要なファイルの現状を確認
3. 実装計画を立案
4. Worker役で実装を実行
5. テストの作成と実行
6. 成果物の確認
7. 完了報告

## 制約事項
- Clean Architectureの原則に従う
- 契約（Protocol）に準拠する
- TDDでテストを先に作成する
- 適切なコミットメッセージを使用

開始してください。
```

### Commander用の指示

```markdown
# Commander役の指示

## あなたの責務
1. タスクの全体像を把握
2. 実装の順序を決定
3. Workerへの指示を明確化
4. 成果物のレビュー
5. 進捗の管理

## Workerへの指示方法
以下の形式でWorkerに指示を出してください：

---
【Worker指示】
作業ID: [例: TASK01-1]
作業内容: [具体的な作業内容]
入力: [必要な情報やファイル]
期待する出力: [成果物の詳細]
制約: [守るべきルールや注意点]
---

## レビューのポイント
- 契約への準拠
- テストの網羅性
- コードの品質
- ドキュメントの完成度
```

### Worker用の指示

```markdown
# Worker役の指示

## あなたの責務
1. Commanderの指示に従って実装
2. テストファーストで開発
3. 適切なエラーハンドリング
4. わかりやすいコード
5. 作業完了の報告

## 作業の進め方
1. 指示内容の確認
2. 必要なファイルの読み込み
3. テストの作成
4. 実装
5. テストの実行（シミュレーション）
6. ドキュメントの更新

## 報告フォーマット
---
【作業完了報告】
作業ID: [対応する作業ID]
完了内容:
- [実装した機能]
- [作成したファイル]
- [更新したファイル]

テスト結果: [PASSEDまたは課題あり]
特記事項: [あれば]
---
```

## タスク01の具体的な指示

```markdown
# タスク01: 設計ドキュメントの完成

## Commander指示
タスク01「設計ドキュメントの完成」を実行してください。
ai-agents/todos/20250706-01-complete-design-docs.md を参照。

まず、以下を確認してください：
1. 既存の契約定義（src/site2/core/ports/）
2. 不足している契約の特定
3. 実装計画の立案

その後、Workerとして実装を進めてください。

## 具体的な成果物
1. detect_contracts.py の作成
2. build_contracts.py の作成
3. pipeline_contracts.py の作成
4. 既存の fetch_contracts.py の確認と必要に応じた更新

## 品質基準
- すべてのProtocolにdocstringがある
- 事前条件・事後条件が明記されている
- 型ヒントが完全である
- エラーケースが定義されている
```

## 便利なコマンド集

```bash
# ファイルの作成
echo '# 内容' > path/to/file.py

# ディレクトリ構造の確認
tree src/site2/core/

# 既存ファイルの確認
cat src/site2/core/ports/fetch_contracts.py

# テストの実行（シミュレーション）
# 実際にはAIが実行結果を推測

# git操作（シミュレーション）
git add .
git commit -m "feat: implement task 01 - complete design documents"
```

## 注意事項

1. **コミットメッセージ**
   - feat: 新機能
   - fix: バグ修正
   - docs: ドキュメント
   - test: テスト
   - refactor: リファクタリング

2. **ファイル作成時**
   - 適切なヘッダーコメント
   - インポートの整理
   - 型ヒントの使用

3. **テスト作成時**
   - 正常系と異常系
   - エッジケース
   - わかりやすいテスト名
