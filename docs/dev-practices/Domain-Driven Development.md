[TOC](/docs/TOC.md)

## ドメイン駆動設計 (DDD) ガイド

このドキュメントは、複雑なビジネス要件を持つソフトウェアを開発・保守していくための強力なアプローチである\*\*DDD（ドメイン駆動設計）\*\*の基本的な考え方と主要な概念をまとめたものです。

### 1\. DDDとは何か？ (What is DDD?)

**DDD (Domain-Driven Design / ドメイン駆動設計)** とは、ソフトウェア開発の関心の中心を、そのソフトウェアが対象とする\*\*「ドメイン（= 事業やビジネスの領域）」\*\*そのものに置き、ドメインの専門家（ドメインエキスパート）と開発者が密に連携しながら、**ビジネスの関心事やルールを直接的に反映したモデル（ドメインモデル）を構築していく**ための設計思想であり、一連のプラクティスです。

#### 🎯 目的

  * **複雑さへの対処**: 複雑で変化し続けるビジネスルールを、整理されたモデルを通じて直接コードに落とし込み、ソフトウェアの複雑さを制御下に置きます。
  * **コミュニケーションの円滑化**: ビジネスサイドと開発サイドの間に存在する「言葉の壁」を取り払い、全員が共通の言葉で会話できるようにします。
  * **ビジネス価値への集中**: ソフトウェアの競争優位性の源泉である「コアドメイン」に注力し、ビジネスの成功に貢献します。

### 2\. DDDの2つの柱：戦略的設計と戦術的設計

DDDは、マクロな視点でモデルの境界線を定める\*\*「戦略的設計」**と、ミクロな視点でモデルの内部を実装する**「戦術的設計」\*\*の2つのパートで構成されます。

-----

### 3\. 戦略的設計：問題領域の地図を作る

戦略的設計は、ソフトウェアが取り組むべき問題空間を分析し、モデルの境界線を定めるためのパターン群です。

#### 🗣️ ユビキタス言語 (Ubiquitous Language)

DDDで**最も重要なコンセプト**です。ドメインエキスパートと開発者が**チーム全員で作り上げ、常に使う共通言語**を指します。
この言語は、会議での会話、ドキュメント、そして\*\*コード（クラス名、メソッド名、変数名）\*\*に至るまで、あらゆる場所で一貫して使われなければなりません。

  * **例**: 「ユーザー」という曖昧な言葉ではなく、「購入者(Buyer)」や「出品者(Seller)」といった、ドメインの文脈に即した正確な言葉を使います。

#### 🗺️ 境界づけられたコンテキスト (Bounded Context)

ユビキタス言語が有効な**境界線**です。同じ言葉でも、文脈（コンテキスト）が異なれば意味が変わることを明確に分離します。

  * **例**: 「商品(Product)」という言葉は、「在庫管理コンテキスト」ではSKUや物理的な場所が重要ですが、「マーケティングコンテキスト」では商品名やキャッチコピー、画像が重要になります。これらは別のコンテキストとしてモデル化します。

-----

### 4\. 戦術的設計：モデルをコードで表現する

戦術的設計は、境界づけられたコンテキスト内で、ドメインモデルを構成する具体的な部品（ビルディングブロック）のパターン群です。

  * **エンティティ (Entity)**
    一意な\*\*識別子(ID)\*\*を持ち、時間と共に状態が変化するオブジェクトです。（例: `User`, `Order`）

  * **値オブジェクト (Value Object)**
    識別子を持たず、**属性値そのものによって定義される**オブジェクトです。不変(Immutable)であることが強く推奨されます。（例: `Money`（金額と通貨）、`Address`（住所））

  * **集約 (Aggregate)**
    データ変更の一貫性を保つための単位で、複数のエンティティや値オブジェクトをまとめたものです。外部からのアクセスは\*\*「集約ルート」\*\*と呼ばれる単一のエンティティを通じてのみ行われます。（例: 「注文」集約は、「注文」エンティティ（ルート）と複数の「注文明細」エンティティから成る）

  * **リポジトリ (Repository)**
    集約の永続化（データベースへの保存や読み出し）を抽象化するインターフェースです。ドメイン層は、データベースの実装を意識することなく、あたかもメモリ上のコレクションのように集約を扱うことができます。

  * **ドメインサービス (Domain Service)**
    特定のエンティティや値オブジェクトに属さない、ドメイン固有のロジック（例: 通貨の換算処理）を配置する場所です。

### まとめ

DDDは、単なる技術的な設計パターン集ではありません。それは、**ビジネスの成功という最終目標に向かって、ソフトウェアの複雑さと真摯に向き合うための包括的なアプローチ**です。全てのプロジェクトに必要なわけではありませんが、ドメインが複雑で、長期的な成長とメンテナンスが求められるプロジェクトにおいて、その真価を発揮します。