[TOC](/docs/TOC.md)

## テスト駆動開発 (TDD) ガイド

このドキュメントは、私たちのチームが採用する開発プラクティスの一つである\*\*TDD（テスト駆動開発）\*\*の目的と、その実践サイクルについてまとめたものです。

### 1\. TDDとは何か？ (What is TDD?)

**TDD (Test-Driven Development / テスト駆動開発)** は、ソフトウェア開発において、**プログラムの本体（プロダクションコード）を書く前に、まずそのコードが満たすべき仕様をテストコードとして記述する**開発手法です。

先に書かれたテストが失敗することを確認し、そのテストをパスさせるために必要最小限のプロダクションコードを実装し、最後にコードを綺麗に（リファクタリング）するという短いサイクルを繰り返します。

#### 🎯 目的

  * **品質の向上**: 実装の前にテストケースを考えることで、仕様の考慮漏れやエッジケースに気づきやすくなり、コードの品質と網羅性が向上します。
  * **安全なリファクタリング**: 堅牢なテストスイートに守られているため、コードの内部構造を改善するリファクタリングを、挙動を壊す心配なく大胆に行えます。
  * **設計の改善**: テストしやすいコードを書くことを強制されるため、自然と疎結合で責務が明確な、メンテナンスしやすい設計になります。
  * **生きた仕様書**: テストコード自体が、プロダクションコードの使い方や仕様を示す正確なドキュメントとして機能します。

### 2\. TDDの開発サイクル：Red-Green-Refactor

TDDは、以下の3つのステップを非常に短いサイクル（数分〜数十分）で繰り返すのが特徴です。

#### 🔴 Step 1: Red - 失敗するテストを書く

まず、これから実装する機能に対する**テストコードを書きます**。この時点では対応するプロダクションコードが存在しないため、このテストは**必ず失敗します**（またはコンパイルエラーになります）。これが「Red」のフェーズです。

これにより、テストが正しく機能していること（ちゃんと失敗を検知できること）を確認します。

#### 🟢 Step 2: Green - テストをパスさせる

次に、**「Red」のテストをパスさせるため**の**必要最小限**のプロダクションコードを書きます。この段階では、コードの綺麗さや効率は考えず、とにかくテストを通すことだけを目的とします。テストが通れば「Green」のフェーズです。

#### REFACTOR - リファクタリングする

最後に、**テストがパスしている状態を維持したまま**、プロダクションコードとテストコードの両方から、重複の排除や命名の改善など、設計の「悪い匂い」を取り除き、コードを綺麗にします。このリファクタリングのステップがあることで、TDDは品質の高いコードを生み出します。

このサイクルを何度も繰り返すことで、ソフトウェアの機能が少しずつ、しかし確実に構築されていきます。

### 3\. TDDとBDDの違い

TDDとBDD（ビヘイビア駆動開発）は密接に関連していますが、焦点が異なります。

| | **TDD (テスト駆動開発)** | **BDD (ビヘイビア駆動開発)** |
| :--- | :--- | :--- |
| **焦点** | **ユニット（部品）の正しい動作** | **システム全体の振る舞い** |
| **視点** | 開発者視点 | ユーザー視点（ビジネス視点を含む） |
| **記述** | プログラミング言語（例: `unittest`） | 自然言語（Gherkin） |
| **目的** | コードの品質と設計の改善 | チーム内の認識合わせ、仕様の明確化 |

簡単に言えば、\*\*TDDは「コードが正しく書かれているか」\*\*を保証するのに対し、\*\*BDDは「正しいコード（振る舞い）を書いているか」\*\*を保証するのに役立ちます。これらは対立するものではなく、組み合わせて使うことで、より効果を発揮します。

### まとめ

TDDは単なるテスト手法ではなく、高品質で保守性の高いソフトウェアを効率的に設計・実装するための開発プロセスです。この「Red-Green-Refactor」のリズムをチームで実践し、自信を持って変更できる堅牢なコードベースを構築していきましょう。